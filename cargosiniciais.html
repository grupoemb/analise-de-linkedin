const form = document.getElementById("linkedinForm");
const status = document.getElementById("status");

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("email").value;
  const pdf = document.getElementById("pdf").files[0];

  // Validações básicas
  if (!email || !pdf) {
    status.innerText = "❌ Por favor, preencha todos os campos.";
    return;
  }

  if (pdf.type !== 'application/pdf') {
    status.innerText = "❌ Por favor, selecione apenas arquivos PDF.";
    return;
  }

  const formData = new FormData();
  formData.append("email", email);
  formData.append("file", pdf);
  formData.append("timestamp", Date.now());

  status.innerText = "⏳ Enviando arquivo...";

  try {
    console.log("Tentando enviar:", {
      email: email,
      fileName: pdf.name,
      fileSize: pdf.size,
      timestamp: Date.now()
    });

    const response = await fetch("https://grupoemb.app.n8n.cloud/webhook-test/6246e0fa-700e-4f22-9ad9-45044dbfaf7c", {
      method: "POST",
      body: formData,
    });

    console.log("Status da resposta:", response.status);
    console.log("Headers:", response.headers);
    
    const responseText = await response.text();
    console.log("Resposta completa:", responseText);

    if (response.ok) {
      status.innerText = "✅ Enviado com sucesso! Sua análise chegará em breve no e-mail informado.";
      form.reset();
    } else {
      status.innerText = `❌ Erro ${response.status}: ${responseText}`;
    }
  } catch (error) {
    console.error("Erro completo:", error);
    status.innerText = `❌ Erro: ${error.message}`;
  }
});
